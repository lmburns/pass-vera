.TH pass-vera 1 "June 2019" "pass-vera"

.SH NAME
pass-vera \- A \fBpass\fP(1) extension that helps to keep the whole tree of
password encrypted inside a \fBvera\fP(1).

.SH SYNOPSIS
\fBpass vera\fP [args] gpgid...
.br
\fBpass open \fP [args]
.br
\fBpass close\fP [args]

.SH DESCRIPTION
Due to the structure of \fBpass\fP(1), file and directory names are not encrypted
in the password store. \fBpass vera\fP provides a convenient solution to put your
password store in an encrypted drive with \fBveracrypt\fP(1) and then keep your
password tree encrypted when you are not using it.

It uses the same GPG key to encrypt passwords (by default) and the veracrypt drive,
therefore you don't need to manage another key. Moreover, you can ask pass-vera
to automatically close your store after a given time.

.TP
.B BBEFORE USING THIS PROGRAM:
Make a backup of your password-store directory. After creating the vera, move the
backup to the location of the mounted drive.

.TP
.B The new workflow is the following:
.IP
1. Create a password vera with \fBpass vera\fP <gpg-id>. It creates a new "vera"
and opens it in PASSWORD_STORE_DIR (if unset, then ~/.password-store). Then it
initializes the password repository with the same GPG key.
.IP
2. Use pass as usual.
.IP
3. When finished close the password vera: \fBpass close\fP.
.IP
4. To use pass again, you need to open the password vera: \fBpass open\fP.


.SH COMMAND

.TP
\fBpass vera\fP [ \fI--no-init\fP, \fI-n\fP ] [\fI--timer=time\fP, \fI-t time\fP]
   [ \fI--path=subfolder\fP, \fI-p subfolder\fP ] [\fI--truecrypt\fP, \fI-r\fP]
   [\fI--vera-key\fP, \fI-k\fP] [\fI--overwrite-key\fP, \fI-o\fP]
   [\fI--force\fP, \fI-f\fP] \fIgpg-id...\fP

Create and initialize a new password vera. This command must be run first,
before a password store can be used. You will be prompted to enter a password
that will encrypt the mounted veracrypt drive.

Use
.I gpg-id
for encryption of both passwords and vera. Multiple gpg-ids may be specified,
in order to encrypt the vera and each password with multiple ids.

If \fI--no-init\fP, \fI-n\fP is specified, do not initialize the password store.
By default, pass-vera initializes the password store with the same key(s) it
generated the vera. The purpose of this option is to give the user the option to
initialize the password store with a different key or set of keys.

If \fI--timer\fP, \fI-t\fP is specified, along with an argument, the password
store will be automatically closed using a \fBlaunchctl\fP(1) timer that runs a script
after a given time. The service will be unloaded once the vera drive is closed dismounted.

.br
Time must be formated in one of the following ways:
\fB(1)\fP 1 hour 5 minutes
\fB(2)\fP 1hour 5minutes
\fB(3)\fP 1 hr 5 mins
\fB(4)\fP 1hr 5mins

If \fI--path\fP or \fI-p\fP is specified, along with an argument,
a specific password vera using gpg-id or a set of gpg-ids is assigned for that
specific subfolder of the password store.

If \fI--truecrypt\fP or \fI-r\fP is specified, veracrypt will enable TrueCrypt
compatibility mode to enable mouting volumes that were created using TrueCrypt
versions 6.x or 7.x. This option can be used by setting the \fIPASSWORD_STORE_VERA_FILE\fP
to a file that is used by TrueCrypt.

If \fI--vera-key\fP or \fI-k\fP is specified, veracrypt will create a key specifically
for the vera drive. This is stored in your home folder and is specified by the
\fIPASSWORD_STORE_VERA_KEY\fP environment variable. If this key is lost, all the data within
the vera will not be accessible.

If \fI--overwrite-key\fP or \fI-o\fP is specified, the existing key that is used
by pass vera to mount the drive will be overwritten with the new kind of key that
is specified. This option should probably be used only whenever one is having some
sort of issue and has backed up all of the data on the existing vera drive.

If \fI--force\fP is specified, the password store will create or mount the
password store to a volume that is in use, or it will force dismount a volume
that is in use. This can also overwrite files, so make sure you are aware of
what you are doing before using this option.

.TP
\fBpass open\fP [\fI--timer=time\fP, \fI-t time\fP] [\fI--truecrypt\fP, \fI-r\fP]
   [\fI--force\fP, \fI-f\fP] [\fIdirectory\fP]

Open a password vera. If a time parameter is given (e.g., 1 hour 5 minutes)
then a launchctl agent will be loaded. After the specified time interval,
a script will run that will dismount the drive and unload the agent.

.TP ADD MULTIPLE TIMERS
If \fI--timer\fP, \fI-t\fP is specified, along with an argument, the password
store will be automatically closed using a launchctl timer after a given time.
If a '.timer' file was already present in the store, this time will be updated,
which updates the launchctl agent. Therefore, multiple timers can be passed, one
extending upon the next.

If \fI--force\fP is specified, the password store will create or mount the
password store to a volume that is in use, or it will force dismount a volume
that is in use. This can also overwrite files, so make sure you are aware of
what you are doing before using this option.

If \fIsubfolder\fP is specified, the password store will be opened in the subfolder.
Otherwise, pass vera will open in \fIPASSWORD_STORE_DIR\fP.

.TP
\fBpass close\fP [\fIstore\fP]
Close a password vera.

If \fIstore\fP is specified, pass close will try to close this store.

.SH OPTIONS
.TP
\fB\-n\fB, \-\-no-init\fR
Do not initialize the password store

.TP
\fB\-t\fB, \-\-timer\fR
Close the store after a given time

.TP
\fB\-p\fB, \-\-path\fR
Create the store for that specific subfolder

.TP
\fB\-r\fB, \-\-truecrypt\fR
Enable compatiblity with TrueCrypt

.TP
\fB\-k\fB, \-\-vera\-key\fR
Create a key with /dev/urandom instead of GPG

.TP
\fB\-o\fB, \-\-overwrite\-key\fR
Overwrite existing key in favor of the one specified

.TP
\fB\-f\fB, \-\-force\fR
Force the vera operations (i.e. even if mounted volume is in use)

.TP
\fB\-q\fB, \-\-quiet\fR
Be quiet

.TP
\fB\-v\fB, \-\-verbose\fR
Be verbose

.TP
\fB\-d\fB, \-\-debug\fR
Enable debuggin of the launch agent. The path of the stderr file will
be $HOME/pass-vera-stderr.log and the path of the stdout file will be
$HOME/pass-vera-stdout.log

.TP
\fB\-\-unsafe\fR
Does not encrypt free space when creating a device-hosted volume

.TP
\fB\-V\fB, \-\-version\fR
Show version information

.TP
\fB\-h\fB, \-\-help\fR
Show usage message


.SH EXAMPLES

.TP
Create a new password vera
.B zx2c4@laptop ~ $ pass vera Jason@zx2c4.com
.br
  Enter password:
.br
  Done: 100.000%  Speed: 4.6 MiB/s  Left: 0 s
.br
  The VeraCrypt volume has been successfully created.
.br
 (*) Your password vera has been created and opened in ~/.password-store.
.br
 (*) Password store initialized for Jason@zx2c4.com.
.br
  .  Your vera is: ~/.password.vera
.br
  .  Your vera key is: ~/.password.key.vera
.br
  .  You can now use pass as usual.
.br
  .  When finished, close the password vera using 'pass close'.

.TP
Open a password vera
.B zx2c4@laptop ~ $ pass open
.br
  Enter password for ~/.password.vera:
.br
 (*) Your password vera has been opened in ~/.password-store.
.br
  .  You can now use pass as usual.
.br
  .  When finished, close the password vera using 'pass close'.

.TP
Close a password vera
.B zx2c4@laptop ~ $ pass close
.br
 (*) Your password vera has been closed.
.br
  .  Your passwords remain present in ~/.password.vera.

.TP
Create a new password vera and set a timer
.B zx2c4@laptop ~ $ pass vera Jason@zx2c4.com --timer=1hr
.br
 (*) Your password vera has been created and opened in ~/.password-store.
.br
 (*) Password store initialized for Jason@zx2c4.com.
.br
  .  Your vera is: ~/.password.vera
.br
  .  Your vera key is: ~/.password.key.vera
.br
  .  You can now use pass as usual.
.br
  .  This password store will be closed in 1h
.br
.B zx2c4@laptop ~ $ pass open
.br
 (*) Your password vera has been opened in ~/.password-store.
.br
  .  You can now use pass as usual.
.br
  .  This password store will be closed in 1h

.TP
Open a password vera and set a timer
.B zx2c4@laptop ~ $ pass open
.br
 (*) Your password vera has been opened in ~/.password-store.
.br
  .  You can now use pass as usual.
.br
  .  This password store will be closed in 10min



.SH ENVIRONMENT VARIABLES
.TP
.I PASSWORD_STORE_VERA
Path to vera executable
.TP
.I PASSWORD_STORE_VERA_FILE
Path to the password vera, by default \fI~/.password.vera\fP
.TP
.I PASSWORD_STORE_VERA_KEY
Path to the password vera key file by default \fI~/.password.key.vera\fP
.TP
.I PASSWORD_STORE_VERA_SIZE
Password vera size in MB, by default \fI10\fP


.SH SEE ALSO
.BR pass(1),
.BR veracrypt(1),
.BR launchctl(1),
.BR pass-import(1),
.BR pass-update(1),
.BR pass-audit(1),
.BR pass-otp(1)


.SH AUTHORS
.B pass vera
.ME .
was written by
.MT lucas@burnsac.xyz
Lucas Burns
.ME .



.SH COPYING
This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
